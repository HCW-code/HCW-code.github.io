---
layout: single
title: "[블록체인] 분산 데이터베이스와 분산원장"
categories: blockchain
tag: [blockchain, 분산원장, 분산 데이터베이스]
toc: true

---

## 분산 데이터베이스와 분산원장

### 분산 데이터베이스

하나의 데이터베이스 관리시스템(DBMS, Database Management System)으로, 여러 CPU에 연결된 저장장치들을 제어하는 형태의 데이터베이스

물리적으로는 여러 위치에 분산 저장하고 흩어져 있는 시스템이지만, 논리적으로는 하나인 것처럼 활용한다는 것이 핵심 개념이다.  
즉 데이터베이스에 접근하는 유저 입장에서는 마치 하나의 데이터베이스에 접근하는 듯한 경험을 제공받는다.  
물리적으로 떨어져 있는 저장소, 즉 노드들은 네트워크를 통해 연결되며 **투명성 확보**가 가장 중요하다.

목표로 하는 투명성 6가지

|   종류   |                         내용                          |           특징           |
| :------: | :---------------------------------------------------: | :----------------------: |
|   병행   |      다수의 트랜잭션 수행 시 결과가 일관성 유지       | 자원처리 양 및 속도 개선 |
|   장애   |     장애 발생이 All or Nothing 유지(원자성 유지)      |      데이터 일관성       |
| 지역사상 |     개별 지역의 물리적 이름과 관계없이 접근 가능      |       확장성 확보        |
|   위치   | 데이터를 물리적 저장 위치가 아닌 논리적 입장에서 접근 |   생산성, 활용성 강화    |
|   중복   |  데이터를 지역별로 중복 저장하여도 데이터 처리 가능   |      병목현상 해소       |
|   분할   | 물리적 구조가 여러 단편으로 분할 저장되어 논리적 사용 |         성능향상         |

### 분산 데이터베이스의 방식

1. 클러스터링

   서버를 여러 개로 만들어 서버 하나가 죽더라도 지속적인 서비스가 가능하여지도록 한 방법

   - 장접 : 성능 유리
   - 단점 : 병목현상, 비용증가
   <center>
   <img src="../../images/2022-08-25-blockchain_6th/image-20220825114203433.png" alt="image-20220825114203433" style="zoom:33%;" />
   [Active-Active는 클러스터를 항상 가동하여 가용할 수 있는 상태로 두는 구성 방식]
   </center>

   <center>
   <img src="../../images/2022-08-25-blockchain_6th/image-20220825114359427.png" alt="image-20220825114359427" style="zoom:33%;" />
   [Active-Standby는 일부 클러스터는 가동하고, 일부 클러스터는 대기 상태로 구성하는 방식]
   </center>
2. 레플리카

   데이터베이스 스토리지를 여러 개로 하는 방식으로 단순 백업 방식과 부하 분산 방식이 있다.

   - 장점 : 데이터베이스 Read(Select) 성능을 높일 수 있다., 지연시간이 거의 없다.
   - 단점 : 각 노드 간의 데이터 동기화 보장이 어렵다. Master 노드가 다운시 대처 어려움
   <center>
   <img src="../../images/2022-08-25-blockchain_6th/image-20220825114710795.png" alt="image-20220825114710795" style="zoom:33%;" />
   [단순 백업 방식]
   </center>

   <center>
   <img src="../../images/2022-08-25-blockchain_6th/image-20220825114749742.png" alt="image-20220825114749742" style="zoom:33%;" />
   [부하 분산 방식]
   </center>
3. 샤딩

   테이블을 나누어 데이터를 처리하는 방식

   - 장점 : 서버의 수평 확장 가능, 쿼리 반응 속도 빨라짐
   - 단점 : 한번 분리한 뒤에는 합치기 어려움, 데이터 적절히 분리하지 못하면 오히려 비효율적일 수 있다.
   <center>
   <img src="../../images/2022-08-25-blockchain_6th/image-20220825114907567.png" alt="image-20220825114907567" style="zoom:33%;" />
   </center>
   - 종류 : 해시 샤딩, 다이나믹 샤딩, 엔티티 샤딩

### 분산 데이터베이스의 장단점

분산 데이터베이스는 두 가지 특징을 갖는다.

- 투명한 분산

  분산 데이터베이스를 사용할 때는 마치 하나의 데이터베이스를 사용하는 것처럼 CRUD 작업을 수행할 수 있어야 한다.  
  따라서 분산 데이터베이스를 구현할 때는 하나처럼 사용하되 실제로는 분산된 형태를 가질 수 있도록 해야 하기 때문에 구현 방법이 복잡하다.

- 투명한 트랜잭션

  각 트랜잭션은 다중 데이터베이스에 걸쳐 일관성을 보장해야 한다.  
  트랜잭션은 일반적으로 여러 하위 트랜잭션으로 분리된 개별 서브 트랜잭션이 하나의 데이터베이스에 대응한다.

|              장점               |                 단점                 |
| :-----------------------------: | :----------------------------------: |
|      시스템의 가용성 확보       | 트랜잭션에 대한 처리 알고리즘이 복잡 |
|  지역업무에 특화된 서비스 제공  |      관리가 복잡하여 비용 증대       |
|      시스템 확장 및 적응성      |  통신망 장애 시 부가적 피해 가능성   |
|     장애에 대한 신뢰성 증진     |       잠재적 오류 내재 가능성        |
| 지역별 자원 활용 및 확자성 용이 |        설계 및 구현의 어려움         |

### 분산 데이터베이스와 블록체인의 차이점

블록체인의 경우

1. **악의적인 사용자를 전제하고 만들어진 시스템(합의 알고리즘)**
2. **운영 주체가 사라져도 시스템 유지 가능(거버넌스)**
<center>
<img src="../../images/2022-08-25-blockchain_6th/image-20220825122545418.png" alt="image-20220825122545418" style="zoom: 33%;" />
</center>
분산 데이터베이스도 데이터를 분산시켜 저장한다는 점에서는 동일하지만 특별히 악의적인 사용자를 전제하지 않는다.  
이는 해당 개념이 나온 배경이 일반적으로 **재해 복구, 백업, 성능상의 이점**만을 고려하였기 때문이다.

하지만 블록체인의 경우 태초부터 <u>악의적인 사용자가 존재할 것이라는 것이라는 가정</u>을 하고, 새로운 블록의 순서와 자격을 결정하는 과정을 합의 알고리즘을 통해 해결한다.

이러한 **합의 과정을 통해서 악의적인 사용자를 방지한다는 점이 기술적으로 가장 큰 차이점**이다

분산 데이터베이스도 특정 기억, 단체에 종속되기 때문에 중앙화된 운영 주체의 정책, 규칙에 따라 언제든지 서비스가 중단될 수 있다. 
블록체인의 경우도 주로 운영하는 주체가 존재하지만, 탈중앙화되어 있기에, 해당 주체가 떠나간다는 극단적인 상황들을 가정해도 나머지 피어들에 의해서 운영될 수 있다.

모든 블록체인은 분산 원장 또는 분산 데이터베이스라고 할 수 있지만 그 반대의 명제는 성립하지 않는다.

### 분산원장 기술(DLT)

거래정보를 기록한 원장을 특정 기관의 중앙 서버가 아닌 P2P 네트워크에 분산하여 참가자가 공동으로 저장하고 기록하는 기술이다.
분산 원장 기술에서는 모든 참여자가 거래내역이 기록된 원장 전체를 각각 보관하고 새로운 거래를 반영하여 갱신하는 작업도 공동으로 수행한다.

이를 위해 P2P 네트워크와 각 노드가 가지는 데이터 사본을 위한 합의 알고리즘이 필요하기도 하다.

기업은 분산 원장 기술을 사용하여 트랜잭션 또는 기타 유형의 데이터 교환을 처리, 검증 또는 인증한다.

블록체인 역시도 이러한 분산 원장 기술의 한 종류이다.

- 장점 : 효율성, 보안성, 시스템 안정성, 투명성
- 단점 : 신뢰 형성에 필요한 매커니즘 설계의 필요성, 악의적인 참가자에 대한 방지 기술 필요

모든 블록체인은 분산 원장이지만, 모든 분산 원장이 블록체인은 아니다.

### 블록체인 도입을 위한 기술적 해결 과제

블록체인이 금융 서비스에 적용되기 위해서는 거래 비밀성, 권한 통제, 신뢰 및 보안 유지, 확장성 확보 등의 기술적 과제가 아직 남아있다.

1. 블록체인에 저장되는 정보는 개인 정보이기 때문에 소유자와 합의된 관리자만 거래 내역에 접근이 가능해야 한다.
2. 신뢰와 보안 유지를 위해서는 비트코인과 같은 퍼블릭 블록체인을 도입하는 것도 고려해야 한다.
3. 실제 사용이 가능하게 하기 위해서는 적어도 초당 3000건 이상 처리할 수 있는 성능을 보유한 블록체인이 필요하다.
4. 분산 원장 기술이 금융에 적용될 경우 발생할 수 있는 검증되지 않은 요소들(보안상의 위험, 법적인 위험성 증가)도 있다.

스마트 계약(Smart Contract)을 분산 원장 기술과 결합해서 사용할 경우,  
소프트웨어 자체의 오류 혹은 의도적인 디도스 공격으로 스마트 계약이 무효화되는 등의 위험성이 있을 수 있다.

금융권의 입장에서 가장 중요한 점은 **대량의 거래 데이터를 신속하게 안전하게 처리하는 것이다.**

블록체인 기반의 분산 원장 기술을 금융 서비스에 도입하는 것은 인프라 구축 비용 절감, 거래 효율성 증가, 안전성 향상 등의 측면에서 많은 이점이 있다.  하지만 거래 비밀성, 권한 통제, 신뢰 및 보안 유지, 확장성 확보 등 기술적 과제 해결이 우선이다.



