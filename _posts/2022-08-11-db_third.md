---
layout: single
title: "[Database] 데이터베이스 설계"
categories: database
tag: [sql, database]

---

**관계형 데이터베이스**

구조화된 데이터는 하나의 테이블로 표현할 수 있다. 사전에 정의된 테이블을 relation이라고도 부르기 때문에 테이블을 사용하는 데이터베이스를 관계형 데이터베이스(Relational database)라고 한다.

다음은 관계형 데이터 베이스를 학습하면서 반드시 알고 있어야 하는 키워드이다.

- 데이터(data) : 각 항목에 저장되는 값
- 테이블(table) : 사전에 정의된 열의 데이터 타입대로 작성된 데이터가 행으로 축적
- 칼럼(column) : 테이블의 한 열을 가리킴
- 레코드(record) : 테이블의 한 행에 저장된 데이터
- 키(key) : 테이블의 각 레코드를 구분할 수 있는 값 (기본키(primary key)과 외래키(foreign key) 등이 있다.)

**관계 종류**

테이블과 테이블 사이의 관계는 다음과 같다.

- 1:1 관계

  하나의 레코드가 다른 테이블의 레코드 한 개와 연결된 경우이다.

  <center>

  <img src="../../images/2022-08-11-db_third/image-20220811001834808.png" alt="image-20220811001834808" style="zoom:33%;" />

  </center><br>

  User테이블의 phone_id는 외래키(foreign key)로써 Phonebook 테이블의 phone_id와 연결되어 있다.

  각 전화번호가 단 한명의 유저와 연결되어 있고, 그 반대도 동일하다면, User테이블과 Phonebook테이블은 1:1관계(One-to-one relationship)이다.

  그러나 1:1관계는 자주 사용하지 않으며 1:1로 나타낼수 있는 관계라면 User테이블에 phone_id를 대신에 phone_number를 직접 저장하는게 나을 수 있다.

- 1:N 관계

  하나의 레코드가 서로 다른 여러 개의 레코드와 연결된 경우이다.

  <center>

  <img src="../../images/2022-08-11-db_third/image-20220811001812617.png" alt="image-20220811001812617" style="zoom:33%;" />

  </center><br>

  이 구조에서는 한명의 유저가 여러 전화번호를 가질수 있으며 여러명의 유저가 하나의 전화번호를 가질 수는 없다. 이런 1:N(일대다) 관계는 관계형 데이터베이스에서 가장 많이 사용된다.

- N:N 관계

  여러 개의 레코드가 다른 테이블의 여러 개의 레코드와 관계가 있는 경우이다. N:N(다대다) 관계를 위해 스키마를 디자인할 때에는, Join 테이블을 만들어 관리한다. 1:N(일대다) 관계와 비슷하지만 양방향에서 다수의 레코드를 가질 수 있다.

  다음과 같이 여행 상품을 관리하는 테이블이 있다고 가정한다. 여러개의 여행 상품이 있고 여러명의 고객이 있다. 고객 한 명은 여러개의 여행 상품을 구매할 수 있고, 여행 상품 하나는 여러 명의 고객이 구매할 수 있다.

  <center>

  <img src="../../images/2022-08-11-db_third/image-20220811002145294.png" alt="image-20220811002145294" style="zoom:33%;" />

  </center><br>

  다대다 관계는 두 개의 일대다 관계와 그 모양이 같다. 두 개의 테이블과 1:N(일대다) 관계를 형성하는 새로운 테이블로 N:N(다대다) 관계를 나타낼 수 있다.

  이렇게 다대다 관계를 위한 테이블을 조인 테이블일고 한다. N:N(다대다) 관계를 그림으로 나타내면 다음과 같다.

  <center>

  <img src="../../images/2022-08-11-db_third/image-20220811002329484.png" alt="image-20220811002329484" style="zoom:40%;" />

  </center><br>

  customer_package 테이블에서는 고객 한 명이 여러 개의 여행 상품을 가질 수 있고, 여행 상품 하나가 여러 개의 고객을 가질 수 있다.

  customer_package 테이블은 customer_id와 package_id를 묶어주는 역할이다. 이 테이블을 통해 어떤 고객이 몇 개의 여행 상품을 구매했는지 또는, 어떠 여행 상품이 몇 명의 고객을 가지고 있는지 등을 확인할 수 있다. 이렇게 조인 테이블을 생성하더라도, 조인 테이블을 위한 기본키는(여기서는 cp_id)는 반드시 있어야 한다.

- self referencing 관계

  때로는 테이블 내에서도 관계가 필요하다. 예를 들어 추천인이 누구인지 파악하기 위해 사용할 수 있다.

  <center>

  <img src="../../images/2022-08-11-db_third/image-20220811003745631.png" alt="image-20220811003745631" style="zoom:33%;" />

  </center><br>

  User 테이블의 recommend_id는 User테이블의 user_id와 연결되어 있다. 한명의 유저(user_id)는 한 명의 추천인(recommend_id)를 가질 수 있다. 그러나 여러 명이 한 명의 유저를 추천인으로 등록할 수 있다. 이 관계는 1:N(일대다) 관계와 유사하다고 생각할 수 있으나 일반적으로 일대다 관계는 서로 다른 테이블의 관계를 나타낼 때 표현하는 방법이다.

